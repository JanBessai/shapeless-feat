sudo: false
language: scala
stages:
  - test
  - name: deploy
    if: branch = master AND NOT type IN (pull_request)

script: sbt +test

jobs:
  include:
    - stage: test
      jdk: openjdk8
    - stage: test
      jdk: oraclejdk11
    - stage: test
      jdk: openjdk11
      script: sbt clean coverage +test && sbt coverageReport coveralls
    - stage: deploy
      jdk: openjdk11
      script: |
        openssl aes-256-cbc -K $encrypted_15ce06f7b2e5_key -iv $encrypted_15ce06f7b2e5_iv -in travis/secrets.tar.enc -out travis/local.secrets.tar -d &&
          tar xv -C travis -f travis/local.secrets.tar &&
          echo $PGP_PASS | gpg --passphrase-fd 0 --batch --yes --import travis/local.secring.asc &&
          sbt +releaseEarly sonatypeBundleRelease
env:
  global:
    - secure: "IeXiQq8JeRMlzTQ/OrfOhrXFW2XosS0c7KEExYavaF6ij3H2QI7zFiIc4MRlwVPvYheZhuzWpmMkYd2ZMCqml34D0fZ85LX/d8cnJIqVIEnv+Cro1hpASJPFNdNteW7uCKu10iy8WSrahqf+mIGovpI19/J+S0xztUl1qta8/DX+n2WliovzZF+M7w3kwETbdx7kyk9BpQFJeRzygDBI1Jeyo9qwKuHgAw+HJcN7rCJuiy7HuS+MyzZMy46fdm91vXjDGRBthp81+mXyCDQoA5xMRL+8LUOhpPWIVp+GQnnmW/LTz/576+nAg4jY279KE+tM2fpZ2b6X8UUUDA2v6Yc7broLwQ+q1rGI7W+HSmqLs1knTE5UAgvXf6hx8jHZ8xE2ZB/HIPP+1WlaGR4eUUyDw7Bqhx0x3OAyMcHJZvYE1FfcTcx99+t42h0lRtq1Uu6MwDv49tzQ7WqLXyXnS+jTgnkxAzheOB41ZERzGnI0SyfDgsKa7zm87wlgVjet+sGkC5g1BiM4hYiF7Gb4A/nwj56acDbhak4TrpUREOWRFIcFqXRqiKXfqT4ooJh9idTe7h8CbvA5LLtnCu0ESMJR0gTugUFqnRbB7GRdPEFx7zMNLgBc/mBxjS1LK+0UiUjQ/7qgff0PbE7nNKMoNZD39NL8+EJWVjMtBEUG7ck="
    - secure: "l6nuWmYwAi6seOVTmdXm23zfMhcrWXcl2lVMD+42LYu6gFF5A38Mg+SsU6jG4vud/Pumm37K9tRIlzJzevErbUmq0iPPd3RT4wswX3QfJJxB8kCLRw+04Yq8Iiz3DeypJecJ2yTLEP4/+8Xqp36X3iQD9hP0oHrlDUW2W6jsu5svEINiDEFcwRu93RM41ZE1EQJdVU34VaGAn4nxpCsSXHD2E36P105LUMBbskpb+7zR9hjI9s8Wsu/r8PgZUUPQ+LMDXihWjRwjapx3me2LcakhI+fxGpGL33WUcBJggrwa4wT6ymqbEY4HBmxdRxNU1YD4lH7CxigEDn2DgLtcAwQ35mzdfLvrP4HfTw02zt+DorWSSKiJi76FaxN7MVSKEjSuuUcEd54dCWcN45TgZhGLR4umcEJ6Fe1ALSalOr75MeHcIJtuhgQUFqy4jasUKVgKDzms0zOacUCXERcJkb2BDIZN4JEy4CucW8zuCQmmijEjdsOoz2E6hkSAzk3O9imTAw65UAQxATF8EkebemcRiaAyZVhztVkI9lHqkDLh10m+atKle9S75b4Pjea+SXL3FZolhXD88m3gI+hHVyDNxHyd66DND2nltZXPqUD/+zBfRETh02wi03F1JhR9HEgp2d641R3MusI6TggNIbdsMma14jZr1VxmmxxixDw="
    - secure: "cx8YOFiX63Qogmk3/vKei5E5Aqwu/zHGVvjrg0+frVLh+nVk3EPRmMqa1f5z0NFXgY4C5fiKln+uIGrR8P+3I/+Qlmp+Vz5jFP1efnu0ryetfQ9RYov3nGDvRX14WVFI5cWaMW/nRu6T6Ysj66IGtCjFbjfEriLBzZTcmJEoRaaNDKgYwRToyAShgsMjnXr1aBQJMCBbcyK5w4nffWsfqb/haF2HHQOPwBmdHCwf1U8WVtFy7qEYshacsKwfQ/O1F8jxZucAHmRKS4NdQIU1SGdOrfxepnHCHH+WJWyo9tWOiuR1yOtmCum+n7i+Uk18woYAxu3enKcg/mq0QH0Viuf4nRDEyxnOTSb4PJ8WXSPLm2uJgpnqnCDVQm3Wtv2348l6x+auIxip7ClC+MqJlHVmewNllqPJ63/1BdDMeDtWvmqGlbp2rfNIvuNkgZH7qJgIlkkk7BurfTJBQJM0zXBLpu6EJdwglfNkLTevQPSqQYG9MR98plVQ9hYNGtknykiKw0e0h+igJa4HJAgQi186OZ9PUFpWO8O3IWUl7a89mkyoVuwYE052F3igP8x1rY5kAga8kHxL7G316x8fMIuzqzXX4L7V7hTIonFTaIU2fAYANgVfFM9+4aTtLGGiAlh77mg/aZnZ2frROPRB6t+X/SLUUHRNe9GOS6cSo54="
